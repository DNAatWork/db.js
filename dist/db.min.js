!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.db=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var g=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},i=b("idb-schema"),j=e(i);!function(b){function d(a){var b=Object.keys(a).sort();if(1===b.length){var c,d,e=b[0],f=a[e];switch(e){case"eq":c="only";break;case"gt":c="lowerBound",d=!0;break;case"lt":c="upperBound",d=!0;break;case"gte":c="lowerBound";break;case"lte":c="upperBound";break;default:throw new TypeError("`"+e+"` is not valid key")}return[c,[f,d]]}var g=a[b[0]],h=a[b[1]],i=b.join("-");switch(i){case"gt-lt":case"gt-lte":case"gte-lt":case"gte-lte":return["bound",[g,h,"gt"===b[0],"lt"===b[1]]];default:throw new TypeError("`"+i+"` are conflicted keys")}}function e(a){if(a&&"object"===("undefined"==typeof a?"undefined":h(a))&&!(a instanceof i)){var b=d(a),c=g(b,2),e=c[0],j=c[1];return i[e].apply(i,f(j))}return a}var i=b.IDBKeyRange||b.webkitIDBKeyRange,k={readonly:"readonly",readwrite:"readwrite"},l=Object.prototype.hasOwnProperty,m=function(a){return a},n=b.indexedDB||b.webkitIndexedDB||b.mozIndexedDB||b.oIndexedDB||b.msIndexedDB||b.shimIndexedDB||function(){throw new Error("IndexedDB required")}(),o={},p=["abort","error","versionchange"],q=function(a,b,c,d){var f=this,g=!1;if(this.getIndexedDB=function(){return a},this.isClosed=function(){return g},this.add=function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];return new Promise(function(c,e){var f=this;if(g)return void e("Database has been closed");var h=d.reduce(function(a,b){return a.concat(b)},[]),i=a.transaction(b,k.readwrite);i.oncomplete=function(){return c(h,f)},i.onerror=function(a){a.preventDefault(),e(a)},i.onabort=function(a){return e(a)};var j=i.objectStore(b);h.forEach(function(a){var b;if(a.item&&a.key){var c=a.key;a=a.item,b=j.add(a,c)}else b=j.add(a);b.onsuccess=function(b){var c=b.target,d=c.source.keyPath;null===d&&(d="__id__"),Object.defineProperty(a,d,{value:c.result,enumerable:!0})}})})},this.update=function(b){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];return new Promise(function(c,e){var f=this;if(g)return void e("Database has been closed");var h=a.transaction(b,k.readwrite);h.oncomplete=function(){return c(j,f)},h.onerror=function(a){return e(a)},h.onabort=function(a){return e(a)};var i=h.objectStore(b),j=d.reduce(function(a,b){return a.concat(b)},[]);j.forEach(function(a){if(a.item&&a.key){var b=a.key;a=a.item,i.put(a,b)}else i.put(a)})})},this.remove=function(b,c){return new Promise(function(d,e){if(g)return void e("Database has been closed");var f=a.transaction(b,k.readwrite);f.oncomplete=function(){return d(c)},f.onerror=function(a){return e(a)},f.onabort=function(a){return e(a)};var h=f.objectStore(b);h["delete"](c)})},this.clear=function(b){return new Promise(function(c,d){if(g)return void d("Database has been closed");var e=a.transaction(b,k.readwrite);e.oncomplete=function(){return c()},e.onerror=function(a){return d(a)},e.onabort=function(a){return d(a)};var f=e.objectStore(b);f.clear()})},this.close=function(){return new Promise(function(c,e){g&&e("Database has been closed"),a.close(),g=!0,delete o[b][d],c()})},this.get=function(b,c){return new Promise(function(d,f){if(g)return void f("Database has been closed");var h=a.transaction(b);h.onerror=function(a){return f(a)},h.onabort=function(a){return f(a)};var i=h.objectStore(b);try{c=e(c)}catch(j){f(j)}var k=i.get(c);k.onsuccess=function(a){return d(a.target.result)}})},this.query=function(b,c){var d=g?"Database has been closed":null;return new r(b,a,c,d)},this.count=function(b,c){return new Promise(function(d,f){if(g)return void f("Database has been closed");var h=a.transaction(b);h.onerror=function(a){return f(a)},h.onabort=function(a){return f(a)};var i=h.objectStore(b);try{c=e(c)}catch(j){f(j)}var k=void 0===c?i.count():i.count(c);k.onsuccess=function(a){return d(a.target.result)}})},this.addEventListener=function(b,c){if(!p.includes(b))throw new Error("Unrecognized event type "+b);a.addEventListener(b,c)},this.removeEventListener=function(b,c){if(!p.includes(b))throw new Error("Unrecognized event type "+b);a.removeEventListener(b,c)},p.forEach(function(a){this[a]=function(b){this.addEventListener(a,b)}},this),!c){var h;return[].some.call(a.objectStoreNames,function(a){if(f[a])return h=new Error('The store name, "'+a+'", which you have attempted to load, conflicts with db.js method names."'),f.close(),!0;f[a]={};var b=Object.keys(f);b.filter(function(a){return![].concat(p,["close","addEventListener","removeEventListener"]).includes(a)}).map(function(b){return f[a][b]=function(){for(var c=arguments.length,d=Array(c),e=0;c>e;e++)d[e]=arguments[e];return f[b].apply(f,[a].concat(d))}})}),h}},r=function(a,b,c,e){var g=this,h=!1,j=function(d,e,g,j,l,m,n){return new Promise(function(o,p){var q=d?i[d].apply(i,f(e)):null,r=[],s=[q],t=0,u=b.transaction(a,h?k.readwrite:k.readonly);u.oncomplete=function(){return o(r)},u.onerror=function(a){return p(a)},u.onabort=function(a){return p(a)};var v=u.objectStore(a),w=c?v.index(c):v;l=l||null,m=m||[],"count"!==g&&s.push(j||"next");var x=h?Object.keys(h):[],y=function(a){return x.forEach(function(b){var c=h[b];c instanceof Function&&(c=c(a)),a[b]=c}),a};w[g].apply(w,s).onsuccess=function(a){var b=a.target.result;if("number"==typeof b)r=b;else if(b)if(null!==l&&l[0]>t)t=l[0],b.advance(l[0]);else if(null!==l&&t>=l[0]+l[1]);else{var c=!0,d="value"in b?b.value:b.key;m.forEach(function(a){a&&a.length&&(c=2===a.length?c&&d[a[0]]===a[1]:c&&a[0](d))}),c&&(t++,h&&(d=y(d),b.update(d)),r.push(n(d))),b["continue"]()}}})},l=function(a,b,c){var d,f,g,i,k,l="next",n="openCursor",o=[],p=null,q=m,r=!1,s=e||c,t=function(){return s?Promise.reject(s):j(a,b,n,r?l+"unique":l,p,o,q)},u=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return p=b.slice(0,2),1===p.length&&p.unshift(0),{execute:t}},v=function(){return l=null,n="count",{execute:t}},w=function(){return n="openKeyCursor",{desc:f,execute:t,filter:d,distinct:g,map:k}};return d=function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return o.push(b.slice(0,2)),{keys:w,execute:t,filter:d,desc:f,distinct:g,modify:i,limit:u,map:k}},f=function(){return l="prev",{keys:w,execute:t,filter:d,distinct:g,modify:i,map:k}},g=function(){return r=!0,{keys:w,count:v,execute:t,filter:d,desc:f,modify:i,map:k}},i=function(a){return h=a,{execute:t}},k=function(a){return q=a,{execute:t,count:v,keys:w,filter:d,desc:f,distinct:g,modify:i,limit:u,map:k}},{execute:t,count:v,keys:w,filter:d,desc:f,distinct:g,modify:i,limit:u,map:k}};["only","bound","upperBound","lowerBound"].forEach(function(a){g[a]=function(){return l(a,arguments)}}),this.range=function(a){var b,c=[null,null];try{c=d(a)}catch(e){b=e}return l.apply(void 0,f(c).concat([b]))},this.filter=function(){var a=l(null,null);return a.filter.apply(a,arguments)},this.all=function(){return this.filter()}},s=function(a,b,c){if(b&&0!==b.length){for(var d=0;d<c.objectStoreNames.length;d++){var e=c.objectStoreNames[d];b.hasOwnProperty(e)||a.currentTarget.transaction.db.deleteObjectStore(e)}var f;for(f in b){var g,h=b[f];g=!l.call(b,f)||c.objectStoreNames.contains(f)?a.currentTarget.transaction.objectStore(f):c.createObjectStore(f,h.key);var i;for(i in h.indexes){var j=h.indexes[i];try{g.index(i)}catch(k){g.createIndex(i,j.key||i,Object.keys(j).length?j:{unique:!1})}}}}},t=function(a,b,c,d){var e=a.target.result;o[b][d]=e;var f=new q(e,b,c,d);return f instanceof Error?Promise.reject(f):Promise.resolve(f)},u={version:"0.14.0",open:function(a){var b=a.server,c=a.version||1,d=a.schema,e=a.noServerMethods,f=void 0;return o[b]||(o[b]={}),new Promise(function(g,i){if(o[b][c])t({target:{result:o[b][c]}},b,e,c).then(g,i);else{var k=function(){if(a.schemaBuilder){f=new j["default"];var h=f.version();try{if(a.schemaBuilder(f),a.version&&c>h)throw new Error("Your highest schema building (IDBSchema) version must not be less than a designated version.");!a.version&&h>c&&(a.version=h)}catch(k){return i(k),{v:void 0}}}if("function"==typeof d)try{d=d()}catch(k){return i(k),{v:void 0}}var l=n.open(b,c);l.onsuccess=function(a){return t(a,b,e,c).then(g,i)},l.onupgradeneeded=f?f.callback():function(a){return s(a,d,a.target.result)},l.onerror=function(a){return i(a)},l.onblocked=function(a){var d=new Promise(function(a,d){l.onsuccess=function(f){t(f,b,e,c).then(a,d)},l.onerror=function(a){return d(a)}});a.resume=d,i(a)}}();if("object"===("undefined"==typeof k?"undefined":h(k)))return k.v}})},"delete":function(a){return new Promise(function(b,c){var d=n.deleteDatabase(a);d.onsuccess=function(a){return b(a)},d.onerror=function(a){return c(a)},d.onblocked=function(a){var b=new Promise(function(b,c){d.onsuccess=function(c){"newVersion"in c||(c.newVersion=a.newVersion),"oldVersion"in c||(c.oldVersion=a.oldVersion),b(c)},d.onerror=function(a){return c(a)}});a.resume=b,c(a)}})},cmp:function(a,b){return n.cmp(a,b)}};"undefined"!=typeof c&&"undefined"!=typeof c.exports?c.exports=u:"function"==typeof a&&a.amd?a(function(){return u}):b.db=u}(self)},{"idb-schema":2}],2:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a){return Array.isArray(a)?a.map(function(a){return f(a)}):(0,m["default"])(a)?Object.keys(a).reduce(function(b,c){return b[c]=f(a[c]),b},{}):a}var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(c,"__esModule",{value:!0});var h=a("object-values"),i=d(h),j=a("is-integer"),k=d(j),l=a("is-plain-obj"),m=d(l),n=Math.pow(2,32)-1,o=function(){function a(){e(this,a),this._stores={},this._current={},this._versions={},this.version(1)}return g(a,[{key:"version",value:function(a){if(!arguments.length)return this._current.version;if(!(0,k["default"])(a)||1>a||a<this.version()||a>n)throw new TypeError("invalid version");return this._current={version:a,store:null},this._versions[a]={stores:[],dropStores:[],indexes:[],dropIndexes:[],callbacks:[],version:a},this}},{key:"addStore",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if("string"!=typeof a||!a)throw new TypeError('"name" is required');if(this._stores[a])throw new TypeError('"'+a+'" store is already defined');var c={name:a,indexes:{},keyPath:b.key||b.keyPath||null,autoIncrement:b.increment||b.autoIncrement||!1};if(c.autoIncrement&&!c.keyPath)throw new TypeError("set keyPath in order to use autoIncrement");return this._stores[a]=c,this._versions[this.version()].stores.push(c),this._current.store=c,this}},{key:"delStore",value:function(a){if("string"!=typeof a||!a)throw new TypeError('"name" is required');var b=this._stores[a];if(!b)throw new TypeError('"'+a+'" store is not defined');return delete this._stores[a],this._versions[this.version()].dropStores.push(b),this._current.store=null,this}},{key:"getStore",value:function(a){if("string"!=typeof a||!a)throw new TypeError('"name" is required');if(!this._stores[a])throw new TypeError('"'+a+'" store is not defined');return this._current.store=this._stores[a],this}},{key:"addIndex",value:function(a,b){var c=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if("string"!=typeof a||!a)throw new TypeError('"name" is required');if("string"!=typeof b&&!Array.isArray(b))throw new TypeError('"field" is required');var d=this._current.store;if(!d)throw new TypeError('set current store using "getStore" or "addStore"');if(d.indexes[a])throw new TypeError('"'+a+'" index is already defined');var e={name:a,field:b,storeName:d.name,multiEntry:c.multi||c.multiEntry||!1,unique:c.unique||!1};return d.indexes[a]=e,this._versions[this.version()].indexes.push(e),this}},{key:"delIndex",value:function(a){if("string"!=typeof a||!a)throw new TypeError('"name" is required');var b=this._current.store.indexes[a];if(!b)throw new TypeError('"'+a+'" index is not defined');return delete this._current.store.indexes[a],this._versions[this.version()].dropIndexes.push(b),this}},{key:"addCallback",value:function(a){return this._versions[this.version()].callbacks.push(a),this}},{key:"callback",value:function(){var a=(0,i["default"])(f(this._versions)).sort(function(a,b){return a.version-b.version});return function(b){var c=b.oldVersion>n?0:b.oldVersion,d=b.target.result,e=b.target.transaction;a.forEach(function(a){c>=a.version||(a.stores.forEach(function(a){var b={};a.keyPath&&(b.keyPath=a.keyPath),a.autoIncrement&&(b.autoIncrement=a.autoIncrement),d.createObjectStore(a.name,b)}),a.dropStores.forEach(function(a){d.deleteObjectStore(a.name)}),a.indexes.forEach(function(a){e.objectStore(a.storeName).createIndex(a.name,a.field,{unique:a.unique,multiEntry:a.multiEntry})}),a.dropIndexes.forEach(function(a){e.objectStore(a.storeName).deleteIndex(a.name)}),a.callbacks.forEach(function(a){a(b)}))})}}},{key:"stores",value:function(){return(0,i["default"])(f(this._stores)).map(function(a){return a.indexes=(0,i["default"])(a.indexes).map(function(a){return delete a.storeName,a}),a})}},{key:"clone",value:function(){var b=this,c=new a;return Object.keys(this).forEach(function(a){return c[a]=f(b[a])}),c}}]),a}();c["default"]=o,b.exports=c["default"]},{"is-integer":4,"is-plain-obj":5,"object-values":7}],3:[function(a,b,c){"use strict";var d=a("number-is-nan");b.exports=Number.isFinite||function(a){return!("number"!=typeof a||d(a)||a===1/0||a===-(1/0))}},{"number-is-nan":6}],4:[function(a,b,c){var d=a("is-finite");b.exports=Number.isInteger||function(a){return"number"==typeof a&&d(a)&&Math.floor(a)===a}},{"is-finite":3}],5:[function(a,b,c){"use strict";var d=Object.prototype.toString;b.exports=function(a){var b;return"[object Object]"===d.call(a)&&(b=Object.getPrototypeOf(a),null===b||b===Object.getPrototypeOf({}))}},{}],6:[function(a,b,c){"use strict";b.exports=Number.isNaN||function(a){return a!==a}},{}],7:[function(a,b,c){"use strict";b.exports=function(a){for(var b=Object.keys(a),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}},{}]},{},[1])(1)});
//# sourceMappingURL=db.min.js.map